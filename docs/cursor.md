# CLAUDE.md

<!-- Generated by Claude Conductor v1.1.2 -->

Context
I am a solo developer working on personal/small projects
This is NOT an enterprise-level project
I prefer simple, direct solutions over "best practices"
I'm a vibe coder who values shipping over perfect architecture
Default Approach
Always assume this is a POC (Proof of Concept) unless explicitly told otherwise
Keep it simple and direct - don't overthink it
Start with the most obvious solution that works
No frameworks unless absolutely necessary
Prefer single files over multiple files when reasonable
Hardcode reasonable defaults instead of building configuration systems
What NOT to do
Don't add abstractions until we actually need them
Don't build for imaginary future requirements
Don't add complex error handling for edge cases that probably won't happen
Don't suggest design patterns unless the problem actually requires them
Don't optimize prematurely
Don't add configuration for things that rarely change
Transition Guidelines
If the POC works and needs to become more robust:
Add basic error handling (try/catch, input validation)
Improve user-facing messages
Extract functions only for readability, not for "reusability"
Keep the same simple approach - just make it more reliable
Language to Use
"Quick POC to test if this works"
"Throwaway prototype"
"Just make it work"
"The dumbest thing that works"
"Keep it simple and direct"
When in Doubt
Ask: "Would copy-pasting this code be simpler than making it generic?" If yes, copy-paste it. '''

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Critical Context (Read First)

- **Tech Stack**: React Native/Expo (frontend), Hono/Cloudflare Workers (backend), Supabase (database), TypeScript
- **Main File**: `/yplus/app/_layout.tsx` (React Native entry), `/backend-engine/src/index.ts` (API server)
- **Core Mechanic**: AI-powered accountability system with voice interactions, VoIP calls, and consequence delivery
- **Key Integration**: Supabase (auth/database), ElevenLabs/Cartesia (TTS), OpenAI (AI), RevenueCat (payments), VoIP push notifications
- **Platform Support**: iOS/Android mobile app with Cloudflare Workers backend
- **DO NOT**: Expose API keys in code, modify onboarding flow without understanding psychological progression, break VoIP call flow

## Session Startup Checklist

**IMPORTANT**: At the start of each session, check these items:

1. **Check TASKS.md** - Look for any IN_PROGRESS or BLOCKED tasks from previous sessions
2. **Review recent JOURNAL.md entries** - Scan last 2-3 entries for context
3. **If resuming work**: Load the current task context from TASKS.md before proceeding

## Table of Contents

### üìö **New Comprehensive Documentation**

1. [**PROJECT INDEX**](yplus/PROJECT_INDEX.md) - Complete project overview, architecture, and developer guide
2. [**COMPONENT GUIDE**](yplus/COMPONENT_GUIDE.md) - Detailed component reference with usage patterns
3. [**API REFERENCE**](yplus/API_REFERENCE.md) - Complete API documentation for services, hooks, and backend

### üìÅ **Legacy Documentation** (To be migrated)

4. [Architecture](ARCHITECTURE.md) - Tech stack, folder structure, infrastructure
5. [Design Tokens](DESIGN.md) - Colors, typography, visual system
6. [UI/UX Patterns](UIUX.md) - Components, interactions, accessibility
7. [Runtime Config](CONFIG.md) - Environment variables, feature flags
8. [Data Model](DATA_MODEL.md) - Database schema, entities, relationships
9. [API Contracts](API.md) - Endpoints, request/response formats, auth
10. [Build & Release](BUILD.md) - Build process, deployment, CI/CD
11. [Testing Guide](TEST.md) - Test strategies, E2E scenarios, coverage
12. [Operational Playbooks](PLAYBOOKS/DEPLOY.md) - Deployment, rollback, monitoring
13. [Contributing](CONTRIBUTING.md) - Code style, PR process, conventions
14. [Error Ledger](ERRORS.md) - Critical P0/P1 error tracking
15. [Task Management](TASKS.md) - Active tasks, phase tracking, context preservation

## Quick Reference

### üöÄ **Key Entry Points**

- **App Entry**: `yplus/app/_layout.tsx:30` - Root layout with providers
- **Main Router**: `yplus/app/index.tsx:20` - App initialization and routing
- **Onboarding**: `yplus/components/OnboardingV3.tsx:45` - 60-step psychological journey
- **VoIP Module**: `yplus/modules/expo-voip-push-token-v2/index.ts:1` - Custom VoIP implementation

### üîß **Core Services**

- **Auth Context**: `yplus/contexts/AuthContext.tsx:17` - Global authentication state
- **Token Manager**: `yplus/services/TokenManager.ts:32` - Push notification tokens
- **API Client**: `yplus/lib/api.ts:8` - Authenticated backend communication
- **Supabase Client**: `yplus/lib/supabase.ts:5` - Database client configuration

### üéØ **Custom Hooks**

- **VoIP Listener**: `yplus/hooks/useVoipListener.ts:15` - Call event management
- **RevenueCat**: `yplus/hooks/useRevenueCat.ts:12` - Subscription management
- **Token Manager**: `yplus/hooks/useTokenManager.ts:23` - Token state management
- **Theme Colors**: `yplus/hooks/useThemeColors.ts:8` - Dynamic theming

### üì± **Key Components**

- **Onboarding Steps**: `yplus/components/steps/v3/` - 20+ specialized assessment components
- **Payment Flow**: `yplus/components/PaywallScreenSimple.tsx:25` - RevenueCat integration
- **Call Interface**: `yplus/app/calls.tsx:30` - VoIP call management screen
- **Settings**: `yplus/app/settings/index.tsx:15` - User preferences management

## Current State

- [x] Feature complete
- [ ] Feature in progress
- [ ] Feature planned
      [Track active work]

## Development Workflow

[5-6 steps for common workflow]

## Task Templates

### 1. [Common Task Name]

1. Step with file:line reference
2. Step with specific action
3. Test step
4. Documentation update

[Include 3-5 templates]

## Anti-Patterns (Avoid These)

‚ùå **Don't [action]** - [Reason]  
[List 5-6 critical mistakes]

## Journal Update Requirements

**IMPORTANT**: Update JOURNAL.md regularly throughout our work sessions:

- After completing any significant feature or fix
- When encountering and resolving errors
- At the end of each work session
- When making architectural decisions
- Format: What/Why/How/Issues/Result structure

## Task Management Integration

**How TASKS.md and JOURNAL.md work together**:

1. **Active Work**: TASKS.md tracks current/incomplete tasks with full context
2. **Completed Work**: When tasks complete, they generate JOURNAL.md entries with `|TASK:ID|` tags
3. **History**: JOURNAL.md preserves complete task history even if Claude Code is reinstalled
4. **Context Recovery**: Search JOURNAL.md for `|TASK:` to see all completed tasks over time
5. **Clean Handoffs**: TASKS.md always shows what needs to be resumed or completed

## Version History

- **v1.0.0** - Initial release
- **v1.1.0** - Feature added (see JOURNAL.md YYYY-MM-DD)  
  [Link major versions to journal entries]
